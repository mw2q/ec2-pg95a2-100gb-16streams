BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%cornflower%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2725285964.94992
 ALGERIA                   |   1997 | 4641499394.65293
 ALGERIA                   |   1996 | 4645817129.12347
 ALGERIA                   |   1995 | 4666284348.56556
 ALGERIA                   |   1994 | 4635988938.85786
 ALGERIA                   |   1993 | 4653366398.58926
 ALGERIA                   |   1992 |  4663561970.8639
 ARGENTINA                 |   1998 |  2728970991.4551
 ARGENTINA                 |   1997 | 4626602845.11456
 ARGENTINA                 |   1996 | 4657990751.69547
 ARGENTINA                 |   1995 | 4636079390.06857
 ARGENTINA                 |   1994 | 4647309558.74713
 ARGENTINA                 |   1993 | 4654562427.65175
 ARGENTINA                 |   1992 | 4663133369.07553
 BRAZIL                    |   1998 | 2729522285.24586
 BRAZIL                    |   1997 | 4644741496.70326
 BRAZIL                    |   1996 | 4646750328.48095
 BRAZIL                    |   1995 |  4633762634.5193
 BRAZIL                    |   1994 | 4646530468.52414
 BRAZIL                    |   1993 |  4644080881.2387
 BRAZIL                    |   1992 |  4632780109.3481
 CANADA                    |   1998 | 2735523056.01475
 CANADA                    |   1997 |  4703112067.1018
 CANADA                    |   1996 | 4672624011.69088
 CANADA                    |   1995 | 4710185949.80766
 CANADA                    |   1994 | 4665695442.28245
 CANADA                    |   1993 |  4665124622.0542
 CANADA                    |   1992 | 4704614648.94543
 CHINA                     |   1998 | 2733814913.20584
 CHINA                     |   1997 | 4680230182.10042
 CHINA                     |   1996 | 4681754209.03694
 CHINA                     |   1995 | 4670413485.41268
 CHINA                     |   1994 | 4671638653.73007
 CHINA                     |   1993 | 4653387054.75961
 CHINA                     |   1992 | 4691614251.47799
 EGYPT                     |   1998 | 2732881520.06203
 EGYPT                     |   1997 | 4670616208.17899
 EGYPT                     |   1996 | 4663239880.72184
 EGYPT                     |   1995 | 4648228922.63622
 EGYPT                     |   1994 | 4664490703.22569
 EGYPT                     |   1993 | 4668844586.92168
 EGYPT                     |   1992 | 4677485886.08245
 ETHIOPIA                  |   1998 | 2767435641.42678
 ETHIOPIA                  |   1997 | 4695566537.36891
 ETHIOPIA                  |   1996 | 4709748116.62237
 ETHIOPIA                  |   1995 | 4689921789.40202
 ETHIOPIA                  |   1994 | 4713414771.35482
 ETHIOPIA                  |   1993 | 4696329656.19436
 ETHIOPIA                  |   1992 |  4705507692.0638
 FRANCE                    |   1998 | 2732655816.86653
 FRANCE                    |   1997 | 4651838717.00316
 FRANCE                    |   1996 | 4672818927.31014
 FRANCE                    |   1995 | 4652776899.15482
 FRANCE                    |   1994 | 4656004105.11159
 FRANCE                    |   1993 | 4649867074.80206
 FRANCE                    |   1992 | 4689153612.49809
 GERMANY                   |   1998 | 2740015927.40608
 GERMANY                   |   1997 | 4679144039.81762
 GERMANY                   |   1996 | 4719682986.61364
 GERMANY                   |   1995 | 4668866467.60026
 GERMANY                   |   1994 | 4695637607.47003
 GERMANY                   |   1993 | 4718581397.99804
 GERMANY                   |   1992 |  4711535716.2613
 INDIA                     |   1998 | 2750289371.13551
 INDIA                     |   1997 | 4680559338.91908
 INDIA                     |   1996 | 4711641304.94286
 INDIA                     |   1995 |  4685996960.7993
 INDIA                     |   1994 | 4671602559.83424
 INDIA                     |   1993 | 4701740534.21289
 INDIA                     |   1992 | 4688541158.03883
 INDONESIA                 |   1998 | 2720686735.97595
 INDONESIA                 |   1997 | 4599305058.05331
 INDONESIA                 |   1996 | 4667200656.95051
 INDONESIA                 |   1995 | 4646766852.19936
 INDONESIA                 |   1994 | 4637537098.69331
 INDONESIA                 |   1993 | 4638354464.09581
 INDONESIA                 |   1992 |  4659802013.8861
 IRAN                      |   1998 | 2722986113.76069
 IRAN                      |   1997 | 4646392311.74077
 IRAN                      |   1996 | 4680511989.95118
 IRAN                      |   1995 | 4650553870.40193
 IRAN                      |   1994 | 4667579146.02011
 IRAN                      |   1993 | 4665186268.23873
 IRAN                      |   1992 | 4656371345.78985
 IRAQ                      |   1998 | 2720558672.70486
 IRAQ                      |   1997 | 4659572782.15568
 IRAQ                      |   1996 | 4654440415.34406
 IRAQ                      |   1995 | 4655008068.18953
 IRAQ                      |   1994 | 4643045515.15689
 IRAQ                      |   1993 | 4642539172.23823
 IRAQ                      |   1992 | 4647303071.70984
 JAPAN                     |   1998 | 2678874149.96784
 JAPAN                     |   1997 | 4590719659.96401
 JAPAN                     |   1996 | 4619986746.98351
 JAPAN                     |   1995 | 4605619797.33393
 JAPAN                     |   1994 | 4591784889.02736
 JAPAN                     |   1993 | 4617405855.05388
 JAPAN                     |   1992 | 4622681473.70552
 JORDAN                    |   1998 | 2714709711.52414
 JORDAN                    |   1997 | 4644766755.19653
 JORDAN                    |   1996 | 4679491861.49663
 JORDAN                    |   1995 | 4650733200.68726
 JORDAN                    |   1994 | 4624099172.40642
 JORDAN                    |   1993 | 4652112164.55949
 JORDAN                    |   1992 | 4678603138.40949
 KENYA                     |   1998 | 2698475533.05074
 KENYA                     |   1997 | 4633951655.42629
 KENYA                     |   1996 | 4631129687.97396
 KENYA                     |   1995 | 4612905688.54208
 KENYA                     |   1994 | 4611335874.75128
 KENYA                     |   1993 | 4616254795.00743
 KENYA                     |   1992 | 4628969315.51748
 MOROCCO                   |   1998 | 2751607814.59391
 MOROCCO                   |   1997 | 4699389588.57576
 MOROCCO                   |   1996 | 4693173668.18425
 MOROCCO                   |   1995 | 4698166670.00943
 MOROCCO                   |   1994 | 4672635685.74376
 MOROCCO                   |   1993 | 4689378984.48647
 MOROCCO                   |   1992 | 4692926866.19205
 MOZAMBIQUE                |   1998 | 2747112203.60172
 MOZAMBIQUE                |   1997 | 4693036098.99856
 MOZAMBIQUE                |   1996 | 4680661307.72321
 MOZAMBIQUE                |   1995 | 4650421767.15382
 MOZAMBIQUE                |   1994 | 4683334741.58529
 MOZAMBIQUE                |   1993 | 4663659916.49116
 MOZAMBIQUE                |   1992 | 4671550567.11863
 PERU                      |   1998 | 2710467932.84824
 PERU                      |   1997 | 4628695774.23929
 PERU                      |   1996 | 4637996599.51778
 PERU                      |   1995 |  4620955003.1403
 PERU                      |   1994 | 4620717200.47685
 PERU                      |   1993 | 4629484516.51543
 PERU                      |   1992 | 4642028801.20313
 ROMANIA                   |   1998 | 2748315192.81241
 ROMANIA                   |   1997 | 4700369902.31663
 ROMANIA                   |   1996 | 4704134562.97472
 ROMANIA                   |   1995 | 4675040218.67663
 ROMANIA                   |   1994 | 4675743653.09884
 ROMANIA                   |   1993 | 4653111511.13785
 ROMANIA                   |   1992 | 4707184180.32912
 RUSSIA                    |   1998 | 2705716010.21867
 RUSSIA                    |   1997 | 4642645802.61124
 RUSSIA                    |   1996 | 4647344100.06582
 RUSSIA                    |   1995 |  4652326490.8784
 RUSSIA                    |   1994 | 4650142235.77983
 RUSSIA                    |   1993 | 4633939125.74087
 RUSSIA                    |   1992 | 4643569021.86013
 SAUDI ARABIA              |   1998 | 2749444032.99535
 SAUDI ARABIA              |   1997 | 4667145477.18001
 SAUDI ARABIA              |   1996 | 4689381670.97057
 SAUDI ARABIA              |   1995 | 4664600751.39321
 SAUDI ARABIA              |   1994 | 4681558242.15234
 SAUDI ARABIA              |   1993 | 4666362252.41458
 SAUDI ARABIA              |   1992 |  4677114970.2154
 UNITED KINGDOM            |   1998 | 2770630944.27555
 UNITED KINGDOM            |   1997 |  4679737608.0535
 UNITED KINGDOM            |   1996 |  4709761389.7257
 UNITED KINGDOM            |   1995 | 4695632390.45697
 UNITED KINGDOM            |   1994 | 4677682397.42271
 UNITED KINGDOM            |   1993 | 4682873357.56429
 UNITED KINGDOM            |   1992 | 4692256421.19793
 UNITED STATES             |   1998 | 2745379664.60204
 UNITED STATES             |   1997 | 4651402636.80455
 UNITED STATES             |   1996 | 4698705485.24277
 UNITED STATES             |   1995 | 4668627924.40341
 UNITED STATES             |   1994 | 4667110514.96303
 UNITED STATES             |   1993 | 4694499969.69766
 UNITED STATES             |   1992 | 4678217856.00405
 VIETNAM                   |   1998 | 2736688545.08216
 VIETNAM                   |   1997 | 4662911516.41942
 VIETNAM                   |   1996 |  4692756153.3807
 VIETNAM                   |   1995 |  4669634083.2401
 VIETNAM                   |   1994 | 4700681707.63212
 VIETNAM                   |   1993 | 4679978685.31162
 VIETNAM                   |   1992 | 4682436073.04855
(175 rows)

COMMIT;
COMMIT
