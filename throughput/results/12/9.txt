BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%honeydew%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2732737077.29801
 ALGERIA                   |   1997 | 4644563432.84882
 ALGERIA                   |   1996 | 4661444433.07005
 ALGERIA                   |   1995 | 4660699669.58257
 ALGERIA                   |   1994 | 4655220079.51807
 ALGERIA                   |   1993 | 4647875659.92108
 ALGERIA                   |   1992 |  4673299262.0786
 ARGENTINA                 |   1998 | 2701029791.31921
 ARGENTINA                 |   1997 | 4656627198.38907
 ARGENTINA                 |   1996 | 4652862376.73861
 ARGENTINA                 |   1995 | 4638237557.11224
 ARGENTINA                 |   1994 | 4643084487.52861
 ARGENTINA                 |   1993 | 4638762078.65293
 ARGENTINA                 |   1992 | 4653961835.46046
 BRAZIL                    |   1998 | 2736863205.28553
 BRAZIL                    |   1997 | 4672915143.02305
 BRAZIL                    |   1996 |  4690846631.8479
 BRAZIL                    |   1995 | 4684047236.78769
 BRAZIL                    |   1994 | 4681364718.64743
 BRAZIL                    |   1993 | 4693862022.22711
 BRAZIL                    |   1992 | 4700681069.17297
 CANADA                    |   1998 | 2742793903.28693
 CANADA                    |   1997 | 4699415490.36595
 CANADA                    |   1996 | 4713624915.38547
 CANADA                    |   1995 | 4685690559.98867
 CANADA                    |   1994 | 4671094303.74024
 CANADA                    |   1993 | 4678114560.02958
 CANADA                    |   1992 | 4703530237.95519
 CHINA                     |   1998 | 2715270607.94563
 CHINA                     |   1997 | 4651365156.62706
 CHINA                     |   1996 | 4665011384.16178
 CHINA                     |   1995 | 4660256925.78043
 CHINA                     |   1994 | 4654229422.36386
 CHINA                     |   1993 | 4663561988.40039
 CHINA                     |   1992 | 4671574151.15964
 EGYPT                     |   1998 |   2726317080.685
 EGYPT                     |   1997 | 4654638981.62497
 EGYPT                     |   1996 | 4690803438.74118
 EGYPT                     |   1995 | 4709316236.69385
 EGYPT                     |   1994 | 4663316408.18215
 EGYPT                     |   1993 | 4662958821.80965
 EGYPT                     |   1992 | 4654151436.90101
 ETHIOPIA                  |   1998 | 2769912270.25696
 ETHIOPIA                  |   1997 | 4727489111.92754
 ETHIOPIA                  |   1996 | 4734023523.95769
 ETHIOPIA                  |   1995 |   4732000696.426
 ETHIOPIA                  |   1994 |  4732955990.7013
 ETHIOPIA                  |   1993 |  4730097813.6376
 ETHIOPIA                  |   1992 | 4771905397.22534
 FRANCE                    |   1998 | 2747132011.86613
 FRANCE                    |   1997 | 4715620984.60686
 FRANCE                    |   1996 |  4720442110.4731
 FRANCE                    |   1995 | 4709087509.41038
 FRANCE                    |   1994 | 4692685983.00824
 FRANCE                    |   1993 | 4690064017.20185
 FRANCE                    |   1992 |  4725903151.9611
 GERMANY                   |   1998 | 2769597826.19903
 GERMANY                   |   1997 | 4698876718.25307
 GERMANY                   |   1996 | 4735947396.41585
 GERMANY                   |   1995 | 4722527285.47377
 GERMANY                   |   1994 | 4708063360.87428
 GERMANY                   |   1993 | 4702441259.86266
 GERMANY                   |   1992 | 4728519615.18824
 INDIA                     |   1998 | 2754443116.48133
 INDIA                     |   1997 | 4676231301.04359
 INDIA                     |   1996 | 4674258066.87343
 INDIA                     |   1995 | 4646700381.57273
 INDIA                     |   1994 | 4644270578.05709
 INDIA                     |   1993 | 4673543089.81914
 INDIA                     |   1992 | 4698304045.46116
 INDONESIA                 |   1998 |  2703529365.3075
 INDONESIA                 |   1997 | 4624158783.37838
 INDONESIA                 |   1996 | 4651974348.04944
 INDONESIA                 |   1995 | 4642866123.89497
 INDONESIA                 |   1994 | 4669217760.16476
 INDONESIA                 |   1993 | 4646760870.40236
 INDONESIA                 |   1992 | 4648006609.09626
 IRAN                      |   1998 | 2744837251.75853
 IRAN                      |   1997 | 4649749852.66483
 IRAN                      |   1996 | 4630242414.18055
 IRAN                      |   1995 | 4655121861.90454
 IRAN                      |   1994 | 4644364103.15351
 IRAN                      |   1993 | 4644643197.03064
 IRAN                      |   1992 | 4665667464.58396
 IRAQ                      |   1998 | 2739481326.32147
 IRAQ                      |   1997 | 4674502982.25357
 IRAQ                      |   1996 |  4660883409.3126
 IRAQ                      |   1995 | 4643407574.88067
 IRAQ                      |   1994 | 4655183722.47903
 IRAQ                      |   1993 | 4622031100.06221
 IRAQ                      |   1992 | 4656895216.87668
 JAPAN                     |   1998 | 2709931323.40124
 JAPAN                     |   1997 | 4647699968.73631
 JAPAN                     |   1996 | 4645025573.81999
 JAPAN                     |   1995 |  4624393204.7619
 JAPAN                     |   1994 | 4655947650.65048
 JAPAN                     |   1993 |  4652101719.8989
 JAPAN                     |   1992 |  4648132938.9344
 JORDAN                    |   1998 | 2743280735.72751
 JORDAN                    |   1997 | 4690439285.62257
 JORDAN                    |   1996 | 4686072147.06202
 JORDAN                    |   1995 | 4689504372.18928
 JORDAN                    |   1994 | 4667114220.94602
 JORDAN                    |   1993 | 4665805971.67594
 JORDAN                    |   1992 | 4704915812.71486
 KENYA                     |   1998 | 2711924080.63247
 KENYA                     |   1997 | 4628124941.58942
 KENYA                     |   1996 | 4652224111.48702
 KENYA                     |   1995 | 4645630916.75922
 KENYA                     |   1994 | 4645572366.25812
 KENYA                     |   1993 | 4656573296.52123
 KENYA                     |   1992 | 4627179461.92376
 MOROCCO                   |   1998 | 2712158187.54615
 MOROCCO                   |   1997 | 4646623787.50879
 MOROCCO                   |   1996 | 4660979395.76594
 MOROCCO                   |   1995 | 4648747334.16115
 MOROCCO                   |   1994 | 4639218945.14772
 MOROCCO                   |   1993 |  4655890309.8272
 MOROCCO                   |   1992 | 4683802235.83782
 MOZAMBIQUE                |   1998 | 2720981606.59667
 MOZAMBIQUE                |   1997 | 4673973802.73553
 MOZAMBIQUE                |   1996 | 4685469969.08273
 MOZAMBIQUE                |   1995 | 4661915152.99547
 MOZAMBIQUE                |   1994 | 4648829245.06749
 MOZAMBIQUE                |   1993 | 4671957804.56577
 MOZAMBIQUE                |   1992 | 4649164265.96714
 PERU                      |   1998 | 2725690677.49444
 PERU                      |   1997 | 4670996572.91117
 PERU                      |   1996 | 4673830978.23773
 PERU                      |   1995 | 4670787117.53257
 PERU                      |   1994 |  4676405067.2239
 PERU                      |   1993 | 4654244750.47025
 PERU                      |   1992 | 4685766232.60208
 ROMANIA                   |   1998 | 2731120363.46956
 ROMANIA                   |   1997 | 4667353610.25736
 ROMANIA                   |   1996 | 4673113743.08603
 ROMANIA                   |   1995 | 4652357471.63621
 ROMANIA                   |   1994 | 4669188985.64158
 ROMANIA                   |   1993 |  4688044778.3971
 ROMANIA                   |   1992 |  4699927605.0567
 RUSSIA                    |   1998 | 2735490170.05033
 RUSSIA                    |   1997 | 4695732826.20706
 RUSSIA                    |   1996 | 4678619033.31743
 RUSSIA                    |   1995 | 4692097394.04794
 RUSSIA                    |   1994 | 4661194439.86759
 RUSSIA                    |   1993 | 4697458196.99958
 RUSSIA                    |   1992 | 4683677178.61276
 SAUDI ARABIA              |   1998 | 2711344281.84327
 SAUDI ARABIA              |   1997 |  4652876101.2288
 SAUDI ARABIA              |   1996 | 4655257500.28963
 SAUDI ARABIA              |   1995 | 4655714905.38935
 SAUDI ARABIA              |   1994 | 4673732845.99057
 SAUDI ARABIA              |   1993 | 4644598671.96267
 SAUDI ARABIA              |   1992 | 4665277205.96301
 UNITED KINGDOM            |   1998 |  2753192206.9211
 UNITED KINGDOM            |   1997 | 4715675633.35148
 UNITED KINGDOM            |   1996 | 4715451273.19123
 UNITED KINGDOM            |   1995 | 4706702209.77197
 UNITED KINGDOM            |   1994 | 4690982893.13496
 UNITED KINGDOM            |   1993 | 4700262653.02116
 UNITED KINGDOM            |   1992 |  4697836193.5845
 UNITED STATES             |   1998 | 2738755148.24472
 UNITED STATES             |   1997 | 4694117930.48285
 UNITED STATES             |   1996 | 4686078820.62027
 UNITED STATES             |   1995 |  4688365751.9945
 UNITED STATES             |   1994 | 4699523626.09224
 UNITED STATES             |   1993 | 4710308449.39038
 UNITED STATES             |   1992 | 4697286657.17291
 VIETNAM                   |   1998 | 2747629082.38599
 VIETNAM                   |   1997 | 4706283614.60777
 VIETNAM                   |   1996 | 4697761511.10413
 VIETNAM                   |   1995 | 4705521570.48511
 VIETNAM                   |   1994 | 4679266485.62883
 VIETNAM                   |   1993 | 4725769051.87362
 VIETNAM                   |   1992 | 4709995916.08772
(175 rows)

COMMIT;
COMMIT
