BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%sienna%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2715236424.57093
 ALGERIA                   |   1997 | 4656378874.35397
 ALGERIA                   |   1996 | 4671315215.76327
 ALGERIA                   |   1995 | 4648793734.64926
 ALGERIA                   |   1994 | 4637274645.74082
 ALGERIA                   |   1993 | 4650542149.52491
 ALGERIA                   |   1992 | 4670788251.09138
 ARGENTINA                 |   1998 | 2709639820.84535
 ARGENTINA                 |   1997 | 4640460925.08162
 ARGENTINA                 |   1996 | 4654136097.25764
 ARGENTINA                 |   1995 |  4630958541.6838
 ARGENTINA                 |   1994 | 4637223743.88087
 ARGENTINA                 |   1993 | 4634362619.12266
 ARGENTINA                 |   1992 | 4656875947.56081
 BRAZIL                    |   1998 | 2745122984.21776
 BRAZIL                    |   1997 | 4668261913.45833
 BRAZIL                    |   1996 | 4685765604.27069
 BRAZIL                    |   1995 | 4684719314.65646
 BRAZIL                    |   1994 |  4663075985.3915
 BRAZIL                    |   1993 | 4678994174.65861
 BRAZIL                    |   1992 | 4669315431.98703
 CANADA                    |   1998 | 2730076872.20308
 CANADA                    |   1997 | 4669156222.54802
 CANADA                    |   1996 | 4670103747.06526
 CANADA                    |   1995 |  4680477307.2697
 CANADA                    |   1994 | 4685763740.20516
 CANADA                    |   1993 | 4667153977.29814
 CANADA                    |   1992 | 4689847648.53956
 CHINA                     |   1998 | 2728166727.85596
 CHINA                     |   1997 | 4658837962.81717
 CHINA                     |   1996 | 4681474133.75791
 CHINA                     |   1995 | 4656585091.52262
 CHINA                     |   1994 | 4661933910.92656
 CHINA                     |   1993 | 4665028914.09173
 CHINA                     |   1992 | 4682974633.61248
 EGYPT                     |   1998 | 2722315034.55096
 EGYPT                     |   1997 | 4652196916.45095
 EGYPT                     |   1996 | 4668981260.49481
 EGYPT                     |   1995 | 4664164022.34873
 EGYPT                     |   1994 | 4662587790.82824
 EGYPT                     |   1993 | 4638640136.39295
 EGYPT                     |   1992 | 4649767947.59448
 ETHIOPIA                  |   1998 | 2761782905.78839
 ETHIOPIA                  |   1997 | 4696979736.47911
 ETHIOPIA                  |   1996 | 4703417946.46062
 ETHIOPIA                  |   1995 | 4697611483.12532
 ETHIOPIA                  |   1994 | 4700960536.00911
 ETHIOPIA                  |   1993 | 4699463736.59449
 ETHIOPIA                  |   1992 | 4713900477.06439
 FRANCE                    |   1998 | 2744447221.73984
 FRANCE                    |   1997 | 4667527717.55259
 FRANCE                    |   1996 | 4690061455.59215
 FRANCE                    |   1995 | 4681777083.23247
 FRANCE                    |   1994 | 4679776262.63539
 FRANCE                    |   1993 | 4659065472.32173
 FRANCE                    |   1992 |  4697266403.8417
 GERMANY                   |   1998 | 2764066474.06625
 GERMANY                   |   1997 | 4698586014.21599
 GERMANY                   |   1996 | 4671099355.18228
 GERMANY                   |   1995 | 4683225434.35054
 GERMANY                   |   1994 | 4690754289.07734
 GERMANY                   |   1993 | 4711329706.93033
 GERMANY                   |   1992 | 4707302514.11847
 INDIA                     |   1998 | 2739379929.56191
 INDIA                     |   1997 | 4668185769.17757
 INDIA                     |   1996 | 4670453706.65354
 INDIA                     |   1995 |   4640969598.952
 INDIA                     |   1994 | 4646470113.87283
 INDIA                     |   1993 | 4664684011.22046
 INDIA                     |   1992 | 4670689352.11617
 INDONESIA                 |   1998 | 2709500366.48399
 INDONESIA                 |   1997 | 4619468448.30038
 INDONESIA                 |   1996 |  4622663272.1502
 INDONESIA                 |   1995 | 4600088459.22349
 INDONESIA                 |   1994 | 4628451087.86121
 INDONESIA                 |   1993 | 4590457642.86634
 INDONESIA                 |   1992 | 4633981890.40374
 IRAN                      |   1998 | 2713989251.24669
 IRAN                      |   1997 | 4646774372.06462
 IRAN                      |   1996 | 4646477204.67966
 IRAN                      |   1995 | 4631115290.92812
 IRAN                      |   1994 | 4638272159.33412
 IRAN                      |   1993 | 4627049091.60584
 IRAN                      |   1992 | 4645363563.34358
 IRAQ                      |   1998 | 2724991228.65399
 IRAQ                      |   1997 | 4666737694.31684
 IRAQ                      |   1996 |   4661286724.706
 IRAQ                      |   1995 | 4673834929.96649
 IRAQ                      |   1994 | 4653310635.19734
 IRAQ                      |   1993 |  4648551692.0942
 IRAQ                      |   1992 | 4681140043.94049
 JAPAN                     |   1998 | 2704181992.38293
 JAPAN                     |   1997 | 4627386161.71682
 JAPAN                     |   1996 | 4643790581.87831
 JAPAN                     |   1995 | 4639487185.79461
 JAPAN                     |   1994 | 4618484206.23368
 JAPAN                     |   1993 | 4628009891.11803
 JAPAN                     |   1992 |  4651831497.4987
 JORDAN                    |   1998 | 2739139138.26916
 JORDAN                    |   1997 | 4678080172.86096
 JORDAN                    |   1996 | 4690521123.27851
 JORDAN                    |   1995 | 4669539285.43216
 JORDAN                    |   1994 | 4651465373.01532
 JORDAN                    |   1993 | 4648596901.30025
 JORDAN                    |   1992 | 4652182611.11961
 KENYA                     |   1998 | 2731919471.67114
 KENYA                     |   1997 | 4633137151.27266
 KENYA                     |   1996 | 4642435778.87058
 KENYA                     |   1995 | 4628965419.19138
 KENYA                     |   1994 | 4639247170.57855
 KENYA                     |   1993 | 4632432614.70916
 KENYA                     |   1992 | 4674060268.83485
 MOROCCO                   |   1998 | 2736146248.08589
 MOROCCO                   |   1997 | 4668114520.70669
 MOROCCO                   |   1996 | 4670459138.44132
 MOROCCO                   |   1995 | 4654158701.38869
 MOROCCO                   |   1994 | 4668433997.75313
 MOROCCO                   |   1993 | 4641060703.97922
 MOROCCO                   |   1992 | 4682450222.43244
 MOZAMBIQUE                |   1998 | 2746305108.77467
 MOZAMBIQUE                |   1997 | 4688664127.41844
 MOZAMBIQUE                |   1996 | 4667194095.20163
 MOZAMBIQUE                |   1995 | 4661986788.76287
 MOZAMBIQUE                |   1994 | 4671715522.50915
 MOZAMBIQUE                |   1993 | 4664077853.77932
 MOZAMBIQUE                |   1992 | 4687184082.90571
 PERU                      |   1998 | 2681400310.92204
 PERU                      |   1997 |   4604078732.169
 PERU                      |   1996 |  4621268138.1198
 PERU                      |   1995 | 4612167621.58723
 PERU                      |   1994 | 4594865317.74131
 PERU                      |   1993 | 4599117737.19859
 PERU                      |   1992 | 4613009797.62443
 ROMANIA                   |   1998 | 2736301252.73693
 ROMANIA                   |   1997 | 4705572648.71354
 ROMANIA                   |   1996 | 4699876963.07457
 ROMANIA                   |   1995 | 4692105637.88968
 ROMANIA                   |   1994 | 4679860371.06147
 ROMANIA                   |   1993 | 4680151964.15403
 ROMANIA                   |   1992 | 4704342164.22148
 RUSSIA                    |   1998 | 2721555512.04463
 RUSSIA                    |   1997 | 4650378109.85375
 RUSSIA                    |   1996 | 4665756798.07909
 RUSSIA                    |   1995 | 4647435778.40878
 RUSSIA                    |   1994 | 4658572925.78258
 RUSSIA                    |   1993 | 4661122558.00273
 RUSSIA                    |   1992 | 4663763779.95484
 SAUDI ARABIA              |   1998 | 2733710110.69457
 SAUDI ARABIA              |   1997 | 4640104807.17418
 SAUDI ARABIA              |   1996 | 4661114952.21335
 SAUDI ARABIA              |   1995 | 4667890087.53587
 SAUDI ARABIA              |   1994 | 4663363757.08543
 SAUDI ARABIA              |   1993 | 4672720933.31409
 SAUDI ARABIA              |   1992 | 4691485600.26493
 UNITED KINGDOM            |   1998 |  2764858343.6106
 UNITED KINGDOM            |   1997 | 4705329237.40966
 UNITED KINGDOM            |   1996 | 4728957408.53305
 UNITED KINGDOM            |   1995 | 4695745673.03237
 UNITED KINGDOM            |   1994 | 4680017997.49333
 UNITED KINGDOM            |   1993 | 4706933194.48765
 UNITED KINGDOM            |   1992 |  4735298143.4042
 UNITED STATES             |   1998 | 2735915430.56136
 UNITED STATES             |   1997 | 4657236839.38105
 UNITED STATES             |   1996 |  4685833087.3503
 UNITED STATES             |   1995 | 4673623953.82969
 UNITED STATES             |   1994 | 4678121552.76458
 UNITED STATES             |   1993 | 4676392583.01917
 UNITED STATES             |   1992 | 4683760054.63341
 VIETNAM                   |   1998 | 2752301542.11026
 VIETNAM                   |   1997 | 4692875306.10851
 VIETNAM                   |   1996 | 4698811221.33214
 VIETNAM                   |   1995 | 4710900523.03274
 VIETNAM                   |   1994 | 4695861395.14008
 VIETNAM                   |   1993 | 4715880883.78292
 VIETNAM                   |   1992 | 4700294918.74905
(175 rows)

COMMIT;
COMMIT
