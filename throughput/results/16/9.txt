BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%burlywood%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2757628734.87494
 ALGERIA                   |   1997 | 4699550051.49361
 ALGERIA                   |   1996 |  4692634100.5175
 ALGERIA                   |   1995 | 4675247576.61173
 ALGERIA                   |   1994 |  4680966793.5056
 ALGERIA                   |   1993 | 4673850718.70971
 ALGERIA                   |   1992 | 4677823827.98118
 ARGENTINA                 |   1998 | 2708154064.83494
 ARGENTINA                 |   1997 | 4640649090.50423
 ARGENTINA                 |   1996 | 4641341372.65733
 ARGENTINA                 |   1995 | 4653964921.48435
 ARGENTINA                 |   1994 | 4636268038.20537
 ARGENTINA                 |   1993 | 4645580377.68745
 ARGENTINA                 |   1992 |  4627143790.1942
 BRAZIL                    |   1998 | 2748050343.05948
 BRAZIL                    |   1997 | 4665222661.47519
 BRAZIL                    |   1996 | 4679041562.37953
 BRAZIL                    |   1995 | 4676206573.94776
 BRAZIL                    |   1994 | 4650803183.53768
 BRAZIL                    |   1993 | 4649791546.93684
 BRAZIL                    |   1992 | 4684408113.84561
 CANADA                    |   1998 | 2760879355.73619
 CANADA                    |   1997 | 4673608581.38193
 CANADA                    |   1996 | 4679992799.19191
 CANADA                    |   1995 |  4675105637.0189
 CANADA                    |   1994 | 4665305814.96935
 CANADA                    |   1993 | 4676003352.52787
 CANADA                    |   1992 | 4716908379.56989
 CHINA                     |   1998 | 2751342777.14825
 CHINA                     |   1997 | 4667676808.24651
 CHINA                     |   1996 | 4676160024.24908
 CHINA                     |   1995 | 4665176244.29436
 CHINA                     |   1994 | 4664223260.34759
 CHINA                     |   1993 | 4686216818.55552
 CHINA                     |   1992 | 4681212205.50741
 EGYPT                     |   1998 | 2733166553.74826
 EGYPT                     |   1997 | 4678349954.76646
 EGYPT                     |   1996 | 4682505917.64285
 EGYPT                     |   1995 |  4664177279.1479
 EGYPT                     |   1994 | 4666038410.04286
 EGYPT                     |   1993 | 4661011139.31485
 EGYPT                     |   1992 | 4673929147.78148
 ETHIOPIA                  |   1998 | 2755046815.05719
 ETHIOPIA                  |   1997 | 4718891038.33366
 ETHIOPIA                  |   1996 | 4711697336.81087
 ETHIOPIA                  |   1995 | 4743678319.74444
 ETHIOPIA                  |   1994 | 4714857965.15598
 ETHIOPIA                  |   1993 | 4698118815.27153
 ETHIOPIA                  |   1992 | 4704686488.52795
 FRANCE                    |   1998 | 2747549129.02082
 FRANCE                    |   1997 | 4685306990.17161
 FRANCE                    |   1996 | 4695051047.06244
 FRANCE                    |   1995 | 4665776079.85335
 FRANCE                    |   1994 |  4691016668.8639
 FRANCE                    |   1993 |  4654157317.3619
 FRANCE                    |   1992 | 4675049678.46763
 GERMANY                   |   1998 | 2740576734.94985
 GERMANY                   |   1997 | 4693214098.74218
 GERMANY                   |   1996 |  4716276668.0191
 GERMANY                   |   1995 | 4685640941.68819
 GERMANY                   |   1994 | 4694847061.39065
 GERMANY                   |   1993 | 4706223581.41232
 GERMANY                   |   1992 | 4694508882.68077
 INDIA                     |   1998 | 2744567403.17527
 INDIA                     |   1997 |  4661430369.5944
 INDIA                     |   1996 | 4662495372.52256
 INDIA                     |   1995 | 4671847868.06439
 INDIA                     |   1994 | 4664182451.88561
 INDIA                     |   1993 | 4658902763.63886
 INDIA                     |   1992 | 4674561403.94784
 INDONESIA                 |   1998 | 2723201482.27112
 INDONESIA                 |   1997 | 4635349404.70017
 INDONESIA                 |   1996 | 4642598778.50137
 INDONESIA                 |   1995 |  4640486194.6681
 INDONESIA                 |   1994 | 4631858462.92545
 INDONESIA                 |   1993 | 4610843295.94859
 INDONESIA                 |   1992 |  4622132634.9877
 IRAN                      |   1998 | 2727194061.06992
 IRAN                      |   1997 | 4620920284.07486
 IRAN                      |   1996 | 4635582755.92113
 IRAN                      |   1995 | 4637578114.38822
 IRAN                      |   1994 | 4636897471.42454
 IRAN                      |   1993 | 4628558065.76009
 IRAN                      |   1992 | 4648767288.43492
 IRAQ                      |   1998 | 2712913106.17483
 IRAQ                      |   1997 | 4644456873.91851
 IRAQ                      |   1996 | 4656419882.46057
 IRAQ                      |   1995 | 4649597858.88797
 IRAQ                      |   1994 | 4633873941.24995
 IRAQ                      |   1993 | 4621100111.92705
 IRAQ                      |   1992 | 4666250693.65255
 JAPAN                     |   1998 | 2704286492.95123
 JAPAN                     |   1997 | 4622941319.12515
 JAPAN                     |   1996 | 4646908639.26624
 JAPAN                     |   1995 | 4629922274.13718
 JAPAN                     |   1994 | 4637055952.90488
 JAPAN                     |   1993 | 4647479317.86405
 JAPAN                     |   1992 | 4641784202.05893
 JORDAN                    |   1998 | 2742259702.15741
 JORDAN                    |   1997 | 4652761811.99513
 JORDAN                    |   1996 | 4646142136.88113
 JORDAN                    |   1995 | 4618571935.23648
 JORDAN                    |   1994 | 4667897369.86365
 JORDAN                    |   1993 | 4649692426.04261
 JORDAN                    |   1992 | 4676175018.06802
 KENYA                     |   1998 | 2706188307.43175
 KENYA                     |   1997 | 4617024396.90551
 KENYA                     |   1996 | 4604820318.89553
 KENYA                     |   1995 | 4615799465.27069
 KENYA                     |   1994 | 4606741100.92069
 KENYA                     |   1993 | 4618972082.82712
 KENYA                     |   1992 | 4619431489.44666
 MOROCCO                   |   1998 | 2742333186.32706
 MOROCCO                   |   1997 | 4690786430.63754
 MOROCCO                   |   1996 | 4711515923.84527
 MOROCCO                   |   1995 | 4687584589.49326
 MOROCCO                   |   1994 | 4686284659.87369
 MOROCCO                   |   1993 | 4669796389.18807
 MOROCCO                   |   1992 | 4702652155.29821
 MOZAMBIQUE                |   1998 | 2738070501.40986
 MOZAMBIQUE                |   1997 | 4659888622.61917
 MOZAMBIQUE                |   1996 | 4675497100.70503
 MOZAMBIQUE                |   1995 | 4657571040.66363
 MOZAMBIQUE                |   1994 | 4655777166.70801
 MOZAMBIQUE                |   1993 | 4664208153.25366
 MOZAMBIQUE                |   1992 | 4675046574.11319
 PERU                      |   1998 | 2695445462.37458
 PERU                      |   1997 | 4598068503.09307
 PERU                      |   1996 | 4611604957.87903
 PERU                      |   1995 | 4613745793.09855
 PERU                      |   1994 | 4615571719.84323
 PERU                      |   1993 |   4601632179.705
 PERU                      |   1992 | 4610283876.65285
 ROMANIA                   |   1998 | 2728803769.45109
 ROMANIA                   |   1997 |  4671851199.4062
 ROMANIA                   |   1996 | 4705523795.43167
 ROMANIA                   |   1995 | 4668470619.74427
 ROMANIA                   |   1994 | 4674849950.82291
 ROMANIA                   |   1993 | 4672856586.78606
 ROMANIA                   |   1992 | 4667288540.87142
 RUSSIA                    |   1998 |  2736044650.6006
 RUSSIA                    |   1997 | 4652396845.52668
 RUSSIA                    |   1996 | 4692228464.51593
 RUSSIA                    |   1995 | 4652377930.45112
 RUSSIA                    |   1994 | 4667825958.81001
 RUSSIA                    |   1993 | 4659503619.32312
 RUSSIA                    |   1992 | 4698298827.25187
 SAUDI ARABIA              |   1998 | 2732988574.31672
 SAUDI ARABIA              |   1997 | 4651687980.19902
 SAUDI ARABIA              |   1996 | 4678126689.85042
 SAUDI ARABIA              |   1995 | 4653700820.48324
 SAUDI ARABIA              |   1994 | 4695944143.09431
 SAUDI ARABIA              |   1993 | 4648790410.44798
 SAUDI ARABIA              |   1992 | 4680849010.68363
 UNITED KINGDOM            |   1998 | 2748912786.92633
 UNITED KINGDOM            |   1997 | 4679493452.76522
 UNITED KINGDOM            |   1996 | 4728002190.59818
 UNITED KINGDOM            |   1995 | 4696105667.82052
 UNITED KINGDOM            |   1994 | 4671451337.08817
 UNITED KINGDOM            |   1993 | 4689902149.57959
 UNITED KINGDOM            |   1992 | 4693548209.16724
 UNITED STATES             |   1998 | 2718560265.98611
 UNITED STATES             |   1997 | 4642262958.56899
 UNITED STATES             |   1996 | 4673746297.57831
 UNITED STATES             |   1995 | 4670148758.42553
 UNITED STATES             |   1994 | 4657025779.93506
 UNITED STATES             |   1993 | 4644018573.43459
 UNITED STATES             |   1992 | 4665069853.26308
 VIETNAM                   |   1998 |  2747131372.0904
 VIETNAM                   |   1997 | 4659086405.39995
 VIETNAM                   |   1996 | 4706165448.73644
 VIETNAM                   |   1995 | 4693360390.51154
 VIETNAM                   |   1994 | 4675525021.76166
 VIETNAM                   |   1993 | 4702725947.47273
 VIETNAM                   |   1992 | 4703190508.98047
(175 rows)

COMMIT;
COMMIT
