BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2731669624.26572
 ALGERIA                   |   1997 | 4682569270.75069
 ALGERIA                   |   1996 | 4691345851.66025
 ALGERIA                   |   1995 |  4679826203.1596
 ALGERIA                   |   1994 | 4650584812.43176
 ALGERIA                   |   1993 | 4663660288.28681
 ALGERIA                   |   1992 | 4693414256.35459
 ARGENTINA                 |   1998 | 2709924205.76811
 ARGENTINA                 |   1997 | 4662140686.24669
 ARGENTINA                 |   1996 | 4667219311.85879
 ARGENTINA                 |   1995 |  4663782103.4674
 ARGENTINA                 |   1994 | 4652614730.80748
 ARGENTINA                 |   1993 | 4631347038.35602
 ARGENTINA                 |   1992 | 4654180138.40037
 BRAZIL                    |   1998 | 2729844476.02317
 BRAZIL                    |   1997 | 4681297729.56225
 BRAZIL                    |   1996 | 4696687443.89274
 BRAZIL                    |   1995 | 4687297750.35413
 BRAZIL                    |   1994 | 4661359181.72994
 BRAZIL                    |   1993 | 4660891997.91651
 BRAZIL                    |   1992 | 4699442929.92374
 CANADA                    |   1998 | 2767850850.75874
 CANADA                    |   1997 | 4701484782.03755
 CANADA                    |   1996 | 4716615669.08567
 CANADA                    |   1995 | 4687045405.29581
 CANADA                    |   1994 | 4707600436.80294
 CANADA                    |   1993 | 4692738330.95243
 CANADA                    |   1992 | 4701712380.67201
 CHINA                     |   1998 | 2727608647.52636
 CHINA                     |   1997 | 4662597434.05332
 CHINA                     |   1996 |  4673093787.3911
 CHINA                     |   1995 | 4694330652.65802
 CHINA                     |   1994 | 4673841572.56668
 CHINA                     |   1993 | 4655067070.69408
 CHINA                     |   1992 | 4663271916.63298
 EGYPT                     |   1998 | 2758523259.84481
 EGYPT                     |   1997 |  4696373026.5122
 EGYPT                     |   1996 | 4711940699.67248
 EGYPT                     |   1995 | 4699084792.58341
 EGYPT                     |   1994 | 4675419914.38308
 EGYPT                     |   1993 | 4675834700.15226
 EGYPT                     |   1992 | 4704086147.88919
 ETHIOPIA                  |   1998 | 2765439605.59218
 ETHIOPIA                  |   1997 | 4711310028.84729
 ETHIOPIA                  |   1996 | 4702893336.57366
 ETHIOPIA                  |   1995 | 4679108515.66079
 ETHIOPIA                  |   1994 | 4726009737.13211
 ETHIOPIA                  |   1993 | 4711351854.26862
 ETHIOPIA                  |   1992 | 4709072107.55625
 FRANCE                    |   1998 | 2741208565.31539
 FRANCE                    |   1997 | 4661702573.67102
 FRANCE                    |   1996 |  4700258979.5126
 FRANCE                    |   1995 | 4652718639.72397
 FRANCE                    |   1994 | 4684906684.85707
 FRANCE                    |   1993 | 4686307008.46061
 FRANCE                    |   1992 | 4692765689.10304
 GERMANY                   |   1998 | 2757875455.56965
 GERMANY                   |   1997 | 4684280250.23942
 GERMANY                   |   1996 | 4696437986.51342
 GERMANY                   |   1995 | 4695252044.80351
 GERMANY                   |   1994 | 4673551164.26181
 GERMANY                   |   1993 | 4710562370.61652
 GERMANY                   |   1992 | 4693152187.17502
 INDIA                     |   1998 | 2738185856.51108
 INDIA                     |   1997 | 4652323332.36603
 INDIA                     |   1996 | 4695921400.26462
 INDIA                     |   1995 | 4668713621.09973
 INDIA                     |   1994 | 4694333328.21943
 INDIA                     |   1993 | 4672681050.56062
 INDIA                     |   1992 | 4692621504.42675
 INDONESIA                 |   1998 |  2714095298.2947
 INDONESIA                 |   1997 | 4612797507.76096
 INDONESIA                 |   1996 | 4615969946.52189
 INDONESIA                 |   1995 | 4611044259.00418
 INDONESIA                 |   1994 | 4610810837.77677
 INDONESIA                 |   1993 | 4597801458.07709
 INDONESIA                 |   1992 | 4578002327.57801
 IRAN                      |   1998 | 2713902432.17793
 IRAN                      |   1997 |  4642773483.6121
 IRAN                      |   1996 | 4612884408.53087
 IRAN                      |   1995 | 4620986868.58177
 IRAN                      |   1994 | 4648997545.95027
 IRAN                      |   1993 | 4650795172.89767
 IRAN                      |   1992 | 4646159653.89914
 IRAQ                      |   1998 | 2723437689.29831
 IRAQ                      |   1997 | 4645221238.73318
 IRAQ                      |   1996 |  4677285141.7526
 IRAQ                      |   1995 | 4615948135.20159
 IRAQ                      |   1994 | 4655238522.26331
 IRAQ                      |   1993 | 4645759906.50204
 IRAQ                      |   1992 | 4665307855.06141
 JAPAN                     |   1998 |  2726776457.9967
 JAPAN                     |   1997 | 4626369655.48631
 JAPAN                     |   1996 | 4670533749.03128
 JAPAN                     |   1995 | 4659496791.02866
 JAPAN                     |   1994 | 4634242872.08333
 JAPAN                     |   1993 | 4622002390.06933
 JAPAN                     |   1992 | 4632483997.56819
 JORDAN                    |   1998 | 2719642204.26569
 JORDAN                    |   1997 | 4628588450.11971
 JORDAN                    |   1996 | 4676920197.03632
 JORDAN                    |   1995 | 4627484157.53229
 JORDAN                    |   1994 | 4643253679.33338
 JORDAN                    |   1993 |  4654943946.6955
 JORDAN                    |   1992 | 4660941679.77895
 KENYA                     |   1998 | 2722682496.60709
 KENYA                     |   1997 | 4611504395.40194
 KENYA                     |   1996 |  4653383586.7387
 KENYA                     |   1995 | 4625332320.24889
 KENYA                     |   1994 | 4638170333.42822
 KENYA                     |   1993 | 4620732839.57433
 KENYA                     |   1992 | 4616891236.81872
 MOROCCO                   |   1998 | 2746172345.10333
 MOROCCO                   |   1997 | 4686322357.38062
 MOROCCO                   |   1996 | 4696355695.13512
 MOROCCO                   |   1995 | 4670391758.71003
 MOROCCO                   |   1994 | 4672313511.73661
 MOROCCO                   |   1993 | 4690471375.88744
 MOROCCO                   |   1992 | 4703416950.54933
 MOZAMBIQUE                |   1998 | 2722559405.05322
 MOZAMBIQUE                |   1997 | 4665025828.05904
 MOZAMBIQUE                |   1996 | 4664886388.74765
 MOZAMBIQUE                |   1995 |  4674252382.9134
 MOZAMBIQUE                |   1994 | 4654217496.59376
 MOZAMBIQUE                |   1993 | 4652279897.25073
 MOZAMBIQUE                |   1992 | 4668256040.73619
 PERU                      |   1998 | 2717671411.83537
 PERU                      |   1997 |  4660716668.2477
 PERU                      |   1996 | 4652594507.48253
 PERU                      |   1995 |  4655079120.2889
 PERU                      |   1994 | 4647860929.27679
 PERU                      |   1993 | 4659165814.82508
 PERU                      |   1992 | 4677359213.80075
 ROMANIA                   |   1998 | 2756022149.23183
 ROMANIA                   |   1997 |  4697258620.0082
 ROMANIA                   |   1996 | 4707199221.29158
 ROMANIA                   |   1995 | 4691497185.26305
 ROMANIA                   |   1994 | 4680635923.17868
 ROMANIA                   |   1993 | 4713872525.91285
 ROMANIA                   |   1992 | 4692782498.61126
 RUSSIA                    |   1998 | 2729989672.97145
 RUSSIA                    |   1997 |  4656204470.2779
 RUSSIA                    |   1996 | 4656949007.92878
 RUSSIA                    |   1995 | 4616804835.91833
 RUSSIA                    |   1994 | 4631167209.16718
 RUSSIA                    |   1993 | 4659906672.65236
 RUSSIA                    |   1992 | 4629655860.27149
 SAUDI ARABIA              |   1998 | 2722990650.87043
 SAUDI ARABIA              |   1997 | 4644115557.64782
 SAUDI ARABIA              |   1996 | 4652908455.07105
 SAUDI ARABIA              |   1995 | 4664743083.27937
 SAUDI ARABIA              |   1994 | 4660131564.00666
 SAUDI ARABIA              |   1993 | 4651816489.54249
 SAUDI ARABIA              |   1992 | 4651580567.62923
 UNITED KINGDOM            |   1998 | 2726802831.14438
 UNITED KINGDOM            |   1997 | 4677167049.31495
 UNITED KINGDOM            |   1996 |  4700109932.0515
 UNITED KINGDOM            |   1995 | 4666424355.91432
 UNITED KINGDOM            |   1994 | 4691668966.24162
 UNITED KINGDOM            |   1993 | 4667318796.18601
 UNITED KINGDOM            |   1992 | 4681245828.06641
 UNITED STATES             |   1998 | 2732649972.31972
 UNITED STATES             |   1997 |  4689728776.8469
 UNITED STATES             |   1996 | 4706891423.82959
 UNITED STATES             |   1995 | 4669303394.73376
 UNITED STATES             |   1994 | 4702503865.40392
 UNITED STATES             |   1993 |  4718133840.3667
 UNITED STATES             |   1992 | 4698048424.91663
 VIETNAM                   |   1998 | 2743833773.79273
 VIETNAM                   |   1997 | 4664327466.24592
 VIETNAM                   |   1996 | 4667004684.66204
 VIETNAM                   |   1995 |   4683807408.601
 VIETNAM                   |   1994 | 4678524015.43739
 VIETNAM                   |   1993 | 4675856216.31557
 VIETNAM                   |   1992 | 4693028234.23051
(175 rows)

COMMIT;
COMMIT
