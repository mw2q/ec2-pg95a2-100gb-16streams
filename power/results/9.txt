BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%chocolate%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2733141739.84947
 ALGERIA                   |   1997 | 4678146719.00893
 ALGERIA                   |   1996 | 4703208154.36102
 ALGERIA                   |   1995 | 4669396868.69575
 ALGERIA                   |   1994 | 4696992636.17324
 ALGERIA                   |   1993 |  4689840835.2046
 ALGERIA                   |   1992 | 4690960237.79795
 ARGENTINA                 |   1998 | 2714026019.21751
 ARGENTINA                 |   1997 | 4636085093.75843
 ARGENTINA                 |   1996 | 4659188467.54599
 ARGENTINA                 |   1995 | 4614793709.88862
 ARGENTINA                 |   1994 | 4621318199.68199
 ARGENTINA                 |   1993 | 4641667521.60415
 ARGENTINA                 |   1992 | 4651094257.92048
 BRAZIL                    |   1998 | 2757279461.41931
 BRAZIL                    |   1997 | 4696726771.12868
 BRAZIL                    |   1996 | 4702688804.17865
 BRAZIL                    |   1995 | 4676731364.34587
 BRAZIL                    |   1994 | 4677497252.74886
 BRAZIL                    |   1993 | 4707582026.99805
 BRAZIL                    |   1992 | 4714008386.73239
 CANADA                    |   1998 |  2749966749.4285
 CANADA                    |   1997 |  4715202001.8508
 CANADA                    |   1996 |  4710782296.6694
 CANADA                    |   1995 | 4706736216.26023
 CANADA                    |   1994 | 4688905903.92993
 CANADA                    |   1993 | 4670342803.16893
 CANADA                    |   1992 | 4697380588.65065
 CHINA                     |   1998 | 2726291412.79795
 CHINA                     |   1997 | 4692581227.50059
 CHINA                     |   1996 | 4688128662.94667
 CHINA                     |   1995 | 4676672247.17971
 CHINA                     |   1994 | 4661272603.47963
 CHINA                     |   1993 | 4657074165.15426
 CHINA                     |   1992 |  4681283798.5327
 EGYPT                     |   1998 |  2742399403.1186
 EGYPT                     |   1997 | 4691919568.46863
 EGYPT                     |   1996 | 4713543569.53159
 EGYPT                     |   1995 | 4677885629.37006
 EGYPT                     |   1994 | 4684148215.59239
 EGYPT                     |   1993 | 4704066879.44178
 EGYPT                     |   1992 |  4692432116.5879
 ETHIOPIA                  |   1998 | 2767488753.97353
 ETHIOPIA                  |   1997 | 4732548478.60394
 ETHIOPIA                  |   1996 | 4716999357.26423
 ETHIOPIA                  |   1995 | 4749672299.76459
 ETHIOPIA                  |   1994 |  4732370597.9571
 ETHIOPIA                  |   1993 | 4713747394.45092
 ETHIOPIA                  |   1992 | 4729020060.55309
 FRANCE                    |   1998 |  2744068461.0725
 FRANCE                    |   1997 | 4678015891.15406
 FRANCE                    |   1996 |  4708885668.6259
 FRANCE                    |   1995 | 4677664420.18283
 FRANCE                    |   1994 | 4680286253.73605
 FRANCE                    |   1993 | 4682496705.66456
 FRANCE                    |   1992 | 4694492000.28482
 GERMANY                   |   1998 | 2742562271.12255
 GERMANY                   |   1997 | 4681894696.80075
 GERMANY                   |   1996 | 4706248126.97502
 GERMANY                   |   1995 | 4705332657.84831
 GERMANY                   |   1994 |  4678729980.8001
 GERMANY                   |   1993 | 4703963857.44659
 GERMANY                   |   1992 | 4699156307.80659
 INDIA                     |   1998 | 2752928323.04788
 INDIA                     |   1997 | 4701584340.01158
 INDIA                     |   1996 | 4677820719.03944
 INDIA                     |   1995 | 4677874407.82568
 INDIA                     |   1994 | 4684727443.52171
 INDIA                     |   1993 | 4707544810.06773
 INDIA                     |   1992 | 4706489281.41932
 INDONESIA                 |   1998 | 2719476777.81091
 INDONESIA                 |   1997 | 4632167685.66645
 INDONESIA                 |   1996 | 4635283619.16987
 INDONESIA                 |   1995 | 4628571725.33938
 INDONESIA                 |   1994 | 4649957388.87938
 INDONESIA                 |   1993 | 4677690990.52353
 INDONESIA                 |   1992 | 4666252092.22079
 IRAN                      |   1998 | 2719690161.68261
 IRAN                      |   1997 |  4668865307.1214
 IRAN                      |   1996 | 4674904343.56049
 IRAN                      |   1995 |  4648588271.7454
 IRAN                      |   1994 | 4665329361.89393
 IRAN                      |   1993 | 4657160700.47758
 IRAN                      |   1992 | 4649589387.01329
 IRAQ                      |   1998 | 2714393530.12316
 IRAQ                      |   1997 |  4694552015.2778
 IRAQ                      |   1996 | 4681638169.00496
 IRAQ                      |   1995 |  4672192833.6252
 IRAQ                      |   1994 | 4648736149.78133
 IRAQ                      |   1993 | 4673862576.41816
 IRAQ                      |   1992 | 4680064395.73735
 JAPAN                     |   1998 |  2725024020.8975
 JAPAN                     |   1997 | 4650948837.87387
 JAPAN                     |   1996 | 4654152863.37092
 JAPAN                     |   1995 | 4637720560.86603
 JAPAN                     |   1994 | 4645991925.95723
 JAPAN                     |   1993 |  4648327099.6057
 JAPAN                     |   1992 | 4646217824.86186
 JORDAN                    |   1998 | 2728699301.24845
 JORDAN                    |   1997 | 4648360330.68558
 JORDAN                    |   1996 |  4653501334.4826
 JORDAN                    |   1995 | 4677842701.65243
 JORDAN                    |   1994 | 4659745904.57852
 JORDAN                    |   1993 | 4639442844.98397
 JORDAN                    |   1992 | 4649780788.93299
 KENYA                     |   1998 | 2723092956.48895
 KENYA                     |   1997 | 4614140333.80373
 KENYA                     |   1996 | 4654129318.89456
 KENYA                     |   1995 | 4644276867.04728
 KENYA                     |   1994 | 4682168570.87214
 KENYA                     |   1993 |  4635760821.4365
 KENYA                     |   1992 | 4619738569.84642
 MOROCCO                   |   1998 | 2765176274.71658
 MOROCCO                   |   1997 | 4699320855.88215
 MOROCCO                   |   1996 | 4723075303.33957
 MOROCCO                   |   1995 | 4689229652.14589
 MOROCCO                   |   1994 | 4690406571.90634
 MOROCCO                   |   1993 | 4675486444.38296
 MOROCCO                   |   1992 | 4717676990.81034
 MOZAMBIQUE                |   1998 | 2738107650.55237
 MOZAMBIQUE                |   1997 | 4697617910.65686
 MOZAMBIQUE                |   1996 | 4697593276.53779
 MOZAMBIQUE                |   1995 | 4694805671.55032
 MOZAMBIQUE                |   1994 |  4704945256.9342
 MOZAMBIQUE                |   1993 | 4687266122.80495
 MOZAMBIQUE                |   1992 | 4716015338.37422
 PERU                      |   1998 | 2710527710.98416
 PERU                      |   1997 | 4687830803.56917
 PERU                      |   1996 | 4668262063.15329
 PERU                      |   1995 |  4654556262.4982
 PERU                      |   1994 | 4653904127.36235
 PERU                      |   1993 |  4639547677.4885
 PERU                      |   1992 | 4649020076.95953
 ROMANIA                   |   1998 | 2739422774.47041
 ROMANIA                   |   1997 | 4653272838.89455
 ROMANIA                   |   1996 | 4664930786.87966
 ROMANIA                   |   1995 | 4652201647.93436
 ROMANIA                   |   1994 | 4674282050.48269
 ROMANIA                   |   1993 |  4641807148.8315
 ROMANIA                   |   1992 | 4651011758.38992
 RUSSIA                    |   1998 | 2731540837.95247
 RUSSIA                    |   1997 | 4669044191.60856
 RUSSIA                    |   1996 | 4675218388.48661
 RUSSIA                    |   1995 | 4668383840.22631
 RUSSIA                    |   1994 | 4681817163.21659
 RUSSIA                    |   1993 | 4685425413.10458
 RUSSIA                    |   1992 | 4693207740.69349
 SAUDI ARABIA              |   1998 |   2741948113.867
 SAUDI ARABIA              |   1997 | 4647630438.53089
 SAUDI ARABIA              |   1996 | 4662207541.93395
 SAUDI ARABIA              |   1995 | 4671060705.90973
 SAUDI ARABIA              |   1994 | 4664655541.74396
 SAUDI ARABIA              |   1993 | 4660245021.03726
 SAUDI ARABIA              |   1992 | 4654448791.00441
 UNITED KINGDOM            |   1998 | 2743901694.18471
 UNITED KINGDOM            |   1997 | 4684427730.79288
 UNITED KINGDOM            |   1996 | 4695700819.48288
 UNITED KINGDOM            |   1995 |  4680701769.9102
 UNITED KINGDOM            |   1994 | 4726473477.85666
 UNITED KINGDOM            |   1993 | 4680674620.37397
 UNITED KINGDOM            |   1992 | 4706131565.51811
 UNITED STATES             |   1998 | 2740025925.38564
 UNITED STATES             |   1997 | 4698096708.82393
 UNITED STATES             |   1996 | 4700072769.27382
 UNITED STATES             |   1995 | 4691288986.98688
 UNITED STATES             |   1994 |  4685641769.6693
 UNITED STATES             |   1993 | 4707599662.13093
 UNITED STATES             |   1992 | 4687530374.26808
 VIETNAM                   |   1998 | 2751035945.01472
 VIETNAM                   |   1997 | 4661599896.10464
 VIETNAM                   |   1996 | 4706261273.74604
 VIETNAM                   |   1995 |  4660978983.5649
 VIETNAM                   |   1994 | 4678594288.04079
 VIETNAM                   |   1993 | 4695602800.44832
 VIETNAM                   |   1992 | 4692974520.93735
(175 rows)

COMMIT;
COMMIT
